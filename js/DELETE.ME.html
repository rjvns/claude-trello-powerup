<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Claude AI Settings</title>
  <link rel="stylesheet" href="https://p.trellocdn.com/power-up.min.css">
  <script src="https://p.trellocdn.com/power-up.min.js"></script>
  <style>
    body { padding: 20px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
    .form-group { margin-bottom: 15px; }
    label { display: block; margin-bottom: 5px; font-weight: 500; }
    input[type="password"] { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
    .btn { background: #0079bf; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; }
    .btn:hover { background: #005a8b; }
    .help-text { font-size: 12px; color: #666; margin-top: 5px; }
  </style>
</head>
<body>
  <div class="form-group">
    <label for="apiKey">Claude API Key:</label>
    <input type="password" id="apiKey" placeholder="Enter your Claude API key">
    <div class="help-text">Get your API key from <a href="https://console.anthropic.com" target="_blank">console.anthropic.com</a></div>
  </div>
  
  <button class="btn" onclick="saveSettings()">Save Settings</button>
  
  <script>
    const t = window.TrelloPowerUp.iframe();
    
    // Load existing settings
    t.get('member', 'private', 'claudeApiKey')
      .then(function(apiKey) {
        if (apiKey) {
          document.getElementById('apiKey').value = apiKey;
        }
      });
    
    function saveSettings() {
      const apiKey = document.getElementById('apiKey').value.trim();
      
      if (!apiKey) {
        alert('Please enter your Claude API key');
        return;
      }
      
      t.set('member', 'private', 'claudeApiKey', apiKey)
        .then(function() {
          t.closePopup();
        })
        .catch(function(error) {
          console.error('Failed to save settings:', error);
          alert('Failed to save settings. Please try again.');
        });
    }
  </script>
</body>
</html>
